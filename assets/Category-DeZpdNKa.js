import{r as o,T as N,U as w,L as r,d as n,a as i,V as S,f as a,o as l,C as D,M as C,N as k,c as M,e as B,P as u,A as T,W as b,J as $,b as c,G as L,p as U,K as A,X as z,Y as F,E as G}from"./index-BB3_t5sF.js";import{u as H}from"./cart-C1uTJAab.js";const J={class:"container"},K={key:0,class:"no-products"},R={class:"product-info"},W=["onClick"],X={class:"product-price"},Y={key:0},j=["src"],q={class:"product-price"},f="http://phptest.com:8080",ee={__name:"Category",setup(O){const d=o({products:[]}),v=o([]),g=o(0),h=o(0),p=o(!1),s=o(null);N(()=>{E(),h.value=window.innerHeight});const E=async()=>{try{const e=await w.get(`${f}/categories`);e.status===200&&e.data&&e.data.code===200?(v.value=e.data.data.data,d.value=v.value[0]||{products:[]}):console.error("获取分类数据失败:",e.data.msg||"未知错误")}catch(e){console.error("请求失败:",e)}},x=e=>{g.value=parseInt(e,10),d.value=v.value[g.value]},y=e=>{s.value=e,p.value=!0},P=H(),V=o([]),I=e=>{P.addToCart(e),V.value.push(e),G({message:"添加成功",type:"success"}),p.value=!1};return(e,m)=>(l(),r("div",J,[n(a(b),{class:"sidebar",style:S({height:h.value+"px"})},{default:i(()=>[n(a(D),{"default-active":g.value.toString(),onSelect:x},{default:i(()=>[(l(!0),r(C,null,k(v.value,(t,_)=>(l(),M(a(T),{key:t.CategoryID,index:_.toString()},{default:i(()=>[B(u(t.CategoryName),1)]),_:2},1032,["index"]))),128))]),_:1},8,["default-active"])]),_:1},8,["style"]),n(a(L),{class:"content"},{default:i(()=>[d.value.products.length===0?(l(),r("div",K," 无此类商品 ")):(l(!0),r(C,{key:1},k(d.value.products,t=>(l(),r("div",{class:"product-list",key:t.ProductID},[n(a($),{class:"product-image",src:f+t.Image,onClick:_=>y(t)},null,8,["src","onClick"]),c("div",R,[c("div",{class:"product-name",onClick:_=>y(t)},u(t.ProductName),9,W),c("div",X,"¥"+u(t.Price),1)])]))),128))]),_:1}),n(a(F),{title:"商品详情",modelValue:p.value,"onUpdate:modelValue":m[1]||(m[1]=t=>p.value=t),width:"30%"},{default:i(()=>[s.value?(l(),r("div",Y,[c("img",{src:f+s.value.Image,class:"detail-image"},null,8,j),c("h3",null,u(s.value.ProductName),1),c("p",null,u(s.value.Description),1),c("p",q,"¥"+u(s.value.Price),1),n(a(U),{type:"primary",icon:a(A),circle:"",plain:"",onClick:m[0]||(m[0]=t=>I(s.value))},null,8,["icon"])])):z("",!0)]),_:1},8,["modelValue"])]))}};export{ee as default};
