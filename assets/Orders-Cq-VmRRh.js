import{I as _,r as O,T as g,L as i,d as a,a as c,Z as N,Y as x,o as m,e as y,b as s,P as n,M as E,N as h,X as k,_ as C,p as T,ax as P,ay as U}from"./index-BB3_t5sF.js";/* empty css                  *//* empty css                   *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                  *//* empty css                    *//* empty css                  */import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F=()=>_.get("/orders"),$=u=>_.get(`/orders/${u}`),A=(u,p)=>_.put(`/orders/${u}`,p),G=u=>_.get(`/products/${u}`),L={class:"orders-container"},M={key:0},z={__name:"Orders",setup(u){const p=O([]),v=O(!1),e=O({}),D=async()=>{try{const r=await F();p.value=r.data.data.data}catch(r){console.error("Failed to fetch orders:",r)}},f=async r=>{try{const t=await $(r.OrderID);e.value=t.data.data.data;for(let o of e.value.orderDetails){const d=await G(o.ProductID);d&&d.data&&d.data.data&&d.data.data.data&&d.data.data.data.ProductName?o.productName=d.data.data.data.ProductName:o.productName="产品详情缺失"}v.value=!0}catch(t){console.error("Failed to fetch order details:",t)}};f();const I=async()=>{if(e.value.OrderID)try{const r=await A(e.value.OrderID,{OrderStatus:e.value.OrderStatus});console.log("Order status updated:",r),await D()}catch(r){console.error("Failed to update order status:",r)}};return g(D),(r,t)=>{const o=C,d=T,S=N,b=P,w=U,V=x;return m(),i("div",L,[a(S,{data:p.value,style:{width:"100%"}},{default:c(()=>[a(o,{prop:"OrderID",label:"订单ID",width:"180"}),a(o,{prop:"OrderDate",label:"订单日期",width:"180"}),a(o,{prop:"TotalAmount",label:"总金额"}),a(o,{prop:"OrderStatus",label:"订单状态"}),a(o,{label:"操作"},{default:c(({row:l})=>[a(d,{type:"text",size:"small",onClick:Q=>f(l)},{default:c(()=>t[2]||(t[2]=[y("查看详情")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(V,{title:"订单详情",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=l=>v.value=l),width:"30%"},{default:c(()=>[e.value?(m(),i("div",M,[s("p",null,"订单ID："+n(e.value.OrderID),1),s("p",null,"用户ID："+n(e.value.UserID),1),s("p",null,"订单日期："+n(e.value.OrderDate),1),s("p",null,"总金额："+n(e.value.TotalAmount),1),s("p",null,[t[3]||(t[3]=y("订单状态： ")),a(w,{modelValue:e.value.OrderStatus,"onUpdate:modelValue":t[0]||(t[0]=l=>e.value.OrderStatus=l),placeholder:"请选择状态",onChange:I},{default:c(()=>[a(b,{label:"未发货",value:"未发货"}),a(b,{label:"已发货",value:"已发货"})]),_:1},8,["modelValue"])]),s("p",null,"用户信息："+n(e.value.user.Username),1),s("p",null,"收货地址："+n(e.value.user.Address),1),t[4]||(t[4]=s("p",null,"订单详情：",-1)),s("ul",null,[(m(!0),i(E,null,h(e.value.orderDetails,l=>(m(),i("li",{key:l.OrderDetailID}," 产品名称："+n(l.productName)+"，数量："+n(l.Quantity),1))),128))])])):k("",!0)]),_:1},8,["modelValue"])])}}},ee=B(z,[["__scopeId","data-v-2d29c668"]]);export{ee as default};
